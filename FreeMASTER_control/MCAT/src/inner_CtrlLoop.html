<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>     
  <head>       
    <meta http-equiv="content-type" content="text/html; charset=windows-1250">       
    <meta name="generator" content="PSPad editor, www.pspad.com">       
    <title>    
    </title>       
    <link href="style.css" rel="stylesheet" type="text/css" />      
    <script type="text/javascript" src="JS_functions\mainInclude.js"></script>
    <script LANGUAGE="JavaScript" type ="text/javascript">
       includeJSfiles();
    </script>
   </head>     
  <body id="CtrlLoop"  onload=" initLoadFormCtrlLoop()" background="images/pozadi.png" >                                          
    <OBJECT id="MCB_PC_Master_Services1" height="1" width="1" classid="clsid:48A185F1-FFDB-11D3-80E3-00C04F176153" name="pcm">	     
    </OBJECT>	        
    <OBJECT CLASSID = "clsid:5220cb21-c88d-11cf-b347-00aa00a28331">         
      <PARAM NAME="LPKPath" VALUE="gmsctls.lpk">         
    </OBJECT>           
    <div style=" position:absolute" >              
      <table width="740px" cellspacing="3px"  border="1" >               
        <tr>      <td>                       
            <div id="pageTitle" class="fontTitle">BLDC Control Loop             
            </div>      </td>             
        </tr>         
      </table>            
                   
      <table width="740" cellspacing="5px"  border="0" >               
          <tr>                 
            <td width="300" align="center" valign="top">                      		                            
            <!-- control control loop input parameters-->     
              <fieldset  style="border:3px color:&gray; width: 100%; height: 100;">
                <legend class="fontControlLabel">Loop Sample Time</legend>        
                <table id="parameterTable" border="0" >            
                  <tr><td>              
                  <script>
                  // control loop sampling period
                  document.write( build_parameter_line("Sample&nbsp;time", "CtrlLOOP_Ts", "sec", "Torque and Speed Control Loop Sampling Period, typical range <1ms;10ms>", 0, ""));
                  </script>	
                  </td></tr>	                            
               </table>
               <table width="100%" id="informativeTable" border="0" >            
                  <tr><td>              
                  <script>
                  document.write( build_divider_line("")); 
                  document.write( build_informative_line("Loop_controllers","PI controller type:", "Parallel"));
                  </script>	
                  </td></tr>	 
                </table>
              </fieldset>
             <!-- TORQUE CONTROL LOOP PARAMETERS -->
             <!-- torque controller limits-->
              <fieldset style="border:3px color:&gray; width: 100%; height: 50;">     
                <legend class="fontControlLabel">Control Loop Output Limits</legend>        
                <table border="0" >            
                  <tr><td>              
                  <script>
                  // torque controller limits
                  document.write( build_parameter_line("Output&nbsp;limit&nbsp;high", "CtrlLOOP_LIM_HIGH", "%", "High limit of BLDC control loop output in percentage of duty cycle", 0, ""));
                  document.write( build_parameter_line("Output&nbsp;limit&nbsp;low", "CtrlLOOP_LIM_LOW", "%", "Low limit of BLDC control loop output in percentage of duty cycle", 0, ""));
                  </script>	
                  </td></tr>	                            
               </table>
              </fieldset>
              <!-- speed ramp-->     
              <fieldset id="SpeedRamp" style="border:3px color:&gray; width: 100%; height: 50;">
                <legend class="fontControlLabel">Speed Ramp </legend>        
                <table  border="0" >            
                  <tr><td>              
                  <script>
                  // speed controller ramp
                  document.write( build_parameter_line("Inc Up","RAMP_UP", "rpm/sec", "Speed Ramp Up Increment , typical range <50;3000> ", 0, "sat"));
                  document.write( build_parameter_line("Inc Down", "RAMP_DOWN", "rpm/sec", "Speed Ramp Down Decrement, typical range <50;3000> ", 0, "sat"));
                  </script>	
                  </td></tr>	                            
               </table>
              </fieldset>
              <!-- torque filter Moving Avarage -->
              <fieldset id="TorqueFilterMaF" style="border:3px color:&gray; width: 100%; height: 25;">
                <legend class="fontControlLabel">Actual Torque Filter</legend>        
                <table  border="0" >            
                  <tr><td>              
                  <script>
                    // MA filter with point number
                    document.write( build_parameter_line("MA Filter", "TLOOP_MAF", "lambda", "Number of 2^n points of Moving Avarage Torque Filter, typical range <0;1>", 0, ""));
                  </script>	
                  </td></tr>	                            
                </table>
              </fieldset>
            </td>                                
            <!-- SPEED CONTROL LOOP PARAMETERS -->  
            <td width="300" align="left" valign="top">                                                 
              <!-- Speed PI parallel controller parameters-->   
              <fieldset id="Speed_PIparal" style="border:3px color:&gray; width: 100%; height: 25;">
                <legend class="fontControlLabel">Speed PI Controller Constants</legend>        
                <table id="SL_PI_const" border="0" style="display:;">            
                  <tr><td>              
                  <script>
                    // speed controller proportional gain and gain scales 
                  document.write( build_constant_line("SL_Kp", "SL_Kp_g", "Speed Controller Proportional constant in time domain"));
                  // speed controller integral gain and gain scales 
                  document.write( build_constant_line( "SL_Ki","SL_Ki_g", "Speed Controller Intergration constant in time domain"));
                   </script>	
                  </td></tr>	                            
               </table>
              <table id="SL_PI_const_param" border="0" >
                <tr><td>              
                  <script>
                    // speed loop controller P and I constant manually edited 
                  document.write(build_parameter_line("Speed&nbsp;Loop&nbsp;Kp" ,"SLOOP_KP_MAN", "", "Speed Controller Proportional constant in time domain", 0, ""));
                  document.write(build_parameter_line("Speed&nbsp;Loop&nbsp;Ki" ,"SLOOP_KI_MAN", "", "Speed Controller Intergration constant in time domain", 0, ""));
                   </script>	
                  </td></tr>	                            
               </table>
              </fieldset>
              <!-- Speed PI reccurent controller parameters-->
              <fieldset  id="Speed_PIrecur" style="border:3px color:&gray; width: 100%; height: 25;">
                <legend class="fontControlLabel">Speed PI Controller Constants</legend>        
                <table border="0" >            
                  <tr><td>              
                  <script>                 
                    document.write( build_constant_line("CC1", "SL_CC1", "Speed Controller Controller CC1 constant in time domain"));
                    document.write( build_constant_line("CC2","SL_CC2", "Speed Controller Controller CC2 constant in time domain"));            
                 </script>	
                  </td></tr>	                            
               </table>
              </fieldset>
               <!-- Torque loop parameters-->   
              <fieldset id="Tloop_PIparal" style="border:3px color:&gray; width: 100%; height: 110;">
                <legend class="fontControlLabel">Torque PI Controller Constants</legend>        
                <table id="TL_PI_const" border="0" >            
                  <tr><td>              
                  <script>
                    // Torque controller proportional and integration gains 
                    document.write( build_constant_line("TL_Kp","TL_Kp_g", "Torque Controller Kp constant in time domain"));
                    document.write( build_constant_line("TL_Ki","TL_Ki_g", "Torque Controller Ki constant in time domain"));
                   </script>	
                  </td></tr>	                            
               </table>
               <table id="TL_PI_const_param" border="0" >
              <tr><td>              
                  <script>
                    // Torque loop controller P and I constant manually edited 
                  document.write(build_parameter_line("Torque&nbsp;Loop&nbsp;Kp" ,"TLOOP_KP_MAN", "", "Torque Controller Proportional constant in time domain", 0, ""));
                  document.write(build_parameter_line("Torque&nbsp;Loop&nbsp;Ki" ,"TLOOP_KI_MAN", "", "Torque Controller Intergration constant in time domain", 0, ""));
                   </script>	
                  </td></tr>	                            
               </table>
              </fieldset> 
              <fieldset  id="Tloop_PIrecur" style="border:3px color:&gray; width: 100%; height: 110;">
                <legend class="fontControlLabel">Torque PI Controller Constants</legend>        
                <table border="0" >            
                  <tr><td>              
                  <script>                 
                    // Torque controller proportional and integration gains
                    document.write( build_constant_line("TL_CC1","TL_CC1", "Torque Controller CC1 constant in time domain"));
                    document.write( build_constant_line("TL_CC2","TL_CC2", "Torque Controller CC2 constant in time domain"));                 
                 </script>	
                  </td></tr>	                            
               </table>
              </fieldset>
              <!-- speed filter Moving Avarage -->
              <fieldset id="SpeedFilterMaF" style="border:3px color:&gray; width: 100%; height: 25;">
                <legend class="fontControlLabel">Actual Speed Filter</legend>        
                <table  border="0" >            
                  <tr><td>              
                  <script>
                    // MA filter with point number
                    document.write( build_parameter_line("Filter&nbsp;order ", "SPEED_MAF", "2^n points", "Number of 2^n points of Moving Avarage Speed Measurement Filter, typical range <1;4>", 0, ""));
                  </script>	
                  </td></tr>	                            
                </table>
              </fieldset>
              <!-- speed filter IIR -->
              <fieldset id="SpeedFilterIIR" style="border:3px color:&gray; width: 100%; height: 25;">
                <legend class="fontControlLabel">Actual Speed Filter</legend>        
                <table  border="0" >            
                  <tr><td>              
                  <script>
                    // cut-off frequency
                    document.write( build_parameter_line("Cut-off&nbsp;freq ", "SPEED_IIR_FREQ", "Hz", "Cut-off Frequency of IIR  Speed Measurement Filter, typical range <20;200>", 0, ""));
                  </script>	
                  </td></tr>	                            
               </table> 
              </fieldset>
              <!--Speed Freedback Filter constants-->   
              <fieldset id="Speed_IIR_filt" style="border:3px color:&gray; width: 100%; height: 110; display:">
                <legend class="fontControlLabel">Speed Feedback Filter Constants</legend>        
                <table border="0" >            
                  <tr><td>              
                  <script>
    	            document.write( build_constant_line("B0", "SL_IIR_B0", "Actual speed filter constant B1"));
                  document.write( build_constant_line("B1", "SL_IIR_B1", "Actual speed filter constant B2"));
                  document.write( build_constant_line("A1", "SL_IIR_A1", "Actual speed filter constant A2"));
                  </script>	
                  </td></tr>	                            
               </table>
              </fieldset>
           </td>                     
        </tr>         
      </table>                      
      <!-- calculation buttons-->
      <table width="740px" cellspacing="3px" border="0" >                     
            <tr>                   
                <td width="180" align="center">                           
                   <button id="CtrlLoopUpdateFrm" onclick="clickUpdateCtrlLoopFM()" style   ="width: 160px; height: 30px; background-color: transparent; border-width: 5px">Update Target                         
                   </button> </td>                       
                <td width="180" align="center">                           
                   <button id="ReloadData" onclick="clickReloadData(); initLoadFormCtrlLoop()" disabled="disabled" style   ="width: 160px; height: 30px; background-color: transparent; border-width: 5px">Reload Data                         
                   </button> </td>
                <td width="180" align="center">                           
                   <button id="StoreData" onclick="clickStoreData()" disabled="disabled" style   ="width: 160px; height: 30px; background-color: transparent; border-width: 5px">Store Data                         
                   </button> </td>                       
            </tr>            
      </table>                 
      <span style="visibility: hidden" face="sans-serif" id="txtErrMsg">.       
      </span>          
    </div>
    <div id="chart1" style="height:300px; width:500px;"></div>
  </body>
</html>