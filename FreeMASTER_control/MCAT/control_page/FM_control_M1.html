<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=windows-1250">
  <meta name="generator" content="PSPad editor, www.pspad.com">
  <title></title>
  <link href="Cntrl_page.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="Control_page.js"></script>
  <style type="text/css">
    .xlink {cursor:pointer}
    .error_on     {background: url("fault_on.png") no-repeat top; background-position: center; width: 125px; height: 45px;vertical-align:middle; text-align: center;font-size:9px; font-family: verdana; font-weight: bold}
    .error_off    {background: url("fault_off.png") no-repeat top; background-position: center; width: 125px; height: 45px; vertical-align:middle; text-align: center;font-size:9px; font-family: verdana; font-weight: bold; color: silver;}
    .run_on       {background: url("red_run_on.png") no-repeat top; width: 35px;background-position: center; background-repeat: no-repeat; background-position: 10% 50%}
    .run_off      {background: url("red_run_off.png") no-repeat top; width: 35px;background-position: center; background-repeat: no-repeat;background-position: 20% 50%}
    .stateTable   {font-size:19px; font-family: verdana; font-weight: normal; border-spacing:10px 20px;text-align: bold}
    .fontControl  {font-size:13px; font-family:verdana; font-weight: normal;text-align: center; font-weight: bold}
    .fontSectionLable {font-size:14px; font-family:verdana; font-weight: normal;text-align: center; font-weight: bold}
    .inputText    {font-size:18px; width: 52px; background-color: transparent; font-family:verdana; text-align: right; font-weight: normal; padding: 0px; border-width: 0px;}
  </style>
  

  <script LANGUAGE="JavaScript" type ="text/javascript">
  
   var StateConection = 0;
   
  
  function Init(){ 
    Errors();   
    StateMachine_M1();          
    buttonsINIT();
	    //read the Active motor status from MCAT
    }
  
  function Periodically(){
      buttonsINIT();
      
      if (StateConection == 1)
      {
        Voltage_Gauge();
        Speed_Gauge();
        StateMachine_M1();          
        ErrorsCheck_M1();
       } 
    }

/* ------------------------ Buttons Initial function -------------------------*/    
  function  buttonsINIT(){
      var retMsg;
      var onoffvar; 
      xmlDoc=loadXMLDoc("check_list.xml");
   
      // On-Off switch Motor 1
      on_off_M1=xmlDoc.getElementsByTagName("M1_onoff")[0];
      if(pcm.ReadVariable(on_off_M1.childNodes[0].nodeValue))
				{
					var onoffvar = pcm.LastVariable_vValue;
					if(onoffvar == 0)
					{
            document.images['onoff_M1'].src='OffBut.png';
          }
          else                                               
          {
            document.images['onoff_M1'].src='OnBut.png';
          }
        }
        
      // Fault Clear button for Motor 1
      clrFlt_M1=xmlDoc.getElementsByTagName("M1_clrFltvar")[0]; 
      if(pcm.ReadVariable(clrFlt_M1.childNodes[0].nodeValue))
				{
					var onoffvar = pcm.LastVariable_vValue;
					if(onoffvar == 0)
					{
            document.images['fltClr_M1'].src='GreenBut.png';
          }
          else
          {
            document.images['fltClr_M1'].src='GreenButPush.png';
          }
        } 

      // Sampling time                   
      if(pcm.ReadVariable(on_off_M1.childNodes[0].nodeValue))
				{
          StateConection = 1;  
          Timer_object = window.setTimeout("Periodically()", 50);
				}
			else
				{
				  StateConection = 0; 
				  Timer_object = window.setTimeout("Periodically()", 2000);
					window.document.getElementById("txtErrMsg").innerHTML = pcm.LastRetMsg;
				}
    }
/* ------------------- End of Buttons Initial function ---------------------- */  
//
/* -------------------------- Errors check function ------------------------- */
    function ErrorsCheck_M1(){
      xmlDoc=   loadXMLDoc("check_list.xml");
      error=    xmlDoc.getElementsByTagName("error");
      fmname=   xmlDoc.getElementsByTagName("FMNAME");
      Ername=   xmlDoc.getElementsByTagName("errorname");
      fmrunname=xmlDoc.getElementsByTagName("FMRUNNAME");
      
      for (i=0;i<error.length;i++)
      {
        if(pcm.ReadVariable(fmname[i].childNodes[0].nodeValue))
				{
					var ValueState = pcm.LastVariable_vValue;
					if(ValueState == 0)
					{
            document.getElementById("M1_" + Ername[i].childNodes[0].nodeValue).className = "error_off";
          }
          else
          {
            document.getElementById("M1_" + Ername[i].childNodes[0].nodeValue).className = "error_on";
          }
				}
				else
				{
					//window.document.getElementById("txtErrMsg").innerHTML = pcm.LastRetMsg;
				}
				if(pcm.ReadVariable(fmrunname[i].childNodes[0].nodeValue))
				{
					var ValueState = pcm.LastVariable_vValue;
					if(ValueState == 0)
					{
            document.getElementById("M1_run_" + Ername[i].childNodes[0].nodeValue).className = "run_off";
          }
          else
          {
            document.getElementById("M1_run_" + Ername[i].childNodes[0].nodeValue).className = "run_on";
          }
				}
				else
				{
					//window.document.getElementById("txtErrMsg").innerHTML = pcm.LastRetMsg;
				}
      } 
    }
/* -------------------- End of Errors check function  ----------------------- */  
//
/* -------------------- Application faults table M1 ------------------------- */   
    function Errors(){
      var InitText_M1 = "";
      xmlDoc=loadXMLDoc("check_list.xml");
      errorTag=xmlDoc.getElementsByTagName("error");
      Ername=xmlDoc.getElementsByTagName("errorname");
      fmname=xmlDoc.getElementsByTagName("FMNAME");
      states=xmlDoc.getElementsByTagName("state"); 
      
      InitText_M1 += "<table border='0' align='center'>"
            
      for (i=0;i<errorTag.length;i++)
      { 

       InitText_M1 += "<tr>";
        
            InitText_M1 += "<td id='M1_"+ Ername[i].childNodes[0].nodeValue +"' class='error_off'>"+ Ername[i].childNodes[0].nodeValue +"</td>";
            InitText_M1 += "<td id='M1_run_"+ Ername[i].childNodes[0].nodeValue +"' class='run_off'></td>";
            i++;
            
            if(i<errorTag.length)
            {
              InitText_M1 += "<td id='M1_"+ Ername[i].childNodes[0].nodeValue +"' class='error_off'>"+ Ername[i].childNodes[0].nodeValue +"</td>";
              InitText_M1 += "<td id='M1_run_"+ Ername[i].childNodes[0].nodeValue +"' class='run_off'></td>";
            }
         InitText_M1 += "</tr>";
        }
      
    InitText_M1 += "</table>"       
      
    document.getElementById("errors_tab_M1").innerHTML =InitText_M1;
    }       
/* ----------------- End of application faults table M1 --------------------- */
//
/* ---------------- On-Off toggle button routine - MOTOR 1 ------------------ */         
    function Power_click_M1(){
      var retMsg;
      var onoffvar; 
      xmlDoc=loadXMLDoc("check_list.xml");
      on_off=xmlDoc.getElementsByTagName("M1_onoff");
      if(pcm.ReadVariable(on_off[0].childNodes[0].nodeValue))
				{
					var onoffvar = pcm.LastVariable_vValue;
					if(onoffvar == 0)
					{
					  onoffvar = 1;
            document.images['onoff_M1'].src     ='OnBut.png';            
          }
          else
          {
            onoffvar = 0;
            document.images['onoff_M1'].src     ='OffBut.png';
          }
				}
				
				succ = pcm.WriteVariable(on_off[0].childNodes[0].nodeValue, onoffvar, retMsg);
    }      
/* ------------ EOF On-Off toggle button routine - MOTOR 1 ------------------ */  
//
/* ------------------ Fault Clear button routine - MOTOR 1 ------------------ */
    function Fault_clr_click_M1(){
      var retMsg;
      var clearFlt; 
      xmlDoc=loadXMLDoc("check_list.xml");
      clr_flt=xmlDoc.getElementsByTagName("M1_clrFltvar");
      if(pcm.ReadVariable(clr_flt[0].childNodes[0].nodeValue))
				{
					var clearFlt = pcm.LastVariable_vValue;
					if(clearFlt == 0)
					{
					  clearFlt = 1;
            document.images['fltClr_M1'].src  ='GreenButPush.png';
          }
          else
          {
					  clearFlt = 0;
            document.images['fltClr_M1'].src  ='GreenBut.png';
          }          
				}                                
				
				succ = pcm.WriteVariable(clr_flt[0].childNodes[0].nodeValue, clearFlt, retMsg);
    } 
/* -------------- EOF Fault Clear button routine - MOTOR 1 ------------------ */  
//
/* ------------------------ Voltage Gauge routine --------------------------- */  
    function Voltage_Gauge(){
      var retMsg;
      var ValueVoltage;
      xmlDoc=loadXMLDoc("check_list.xml");
      var ActualVoltage =xmlDoc.getElementsByTagName("M1_ActualVoltage");
      
      if(pcm.ReadVariable(ActualVoltage[0].childNodes[0].nodeValue))
      {
        ValueVoltage = pcm.LastVariable_vValue;
        gaugeVdcBUS_M1.NeedleID = 0;
        gaugeVdcBUS_M1.NeedleValue = ValueVoltage;
      }
        else
      {
        //window.document.getElementById("txtErrMsg").innerHTML = pcm.LastRetMsg;
      }
    }  
/* --------------------- End of Voltage Gauge routine ----------------------- */
//
/* ------------------------ Speed Gauge routine ----------------------------- */  
    function Speed_Gauge(){
      var retMsg;
      var ValueSpeed;
      xmlDoc=loadXMLDoc("check_list.xml");
      
      var ActualSpeed=xmlDoc.getElementsByTagName("M1_ActualSpeed")[0];
      if(pcm.ReadVariable(ActualSpeed.childNodes[0].nodeValue))
      {
        ValueSpeed = pcm.LastVariable_vValue;
        gaugeSPEED_M1.NeedleID = 0;
        gaugeSPEED_M1.NeedleValue = ValueSpeed;
      }
        else
      {
        //window.document.getElementById("txtErrMsg").innerHTML = pcm.LastRetMsg;
      }
      
      var RequestedSpeed=xmlDoc.getElementsByTagName("M1_RequiredSpeed");
      if(pcm.ReadVariable(RequestedSpeed[0].childNodes[0].nodeValue))
      {
        ValueSpeed = pcm.LastVariable_vValue;
        gaugeSPEED_M1.NeedleID = 1;
        gaugeSPEED_M1.NeedleValue = ValueSpeed;
      }
        else
      {
        //window.document.getElementById("txtErrMsg").innerHTML = pcm.LastRetMsg;
      }
         
    }  
/* --------------------- End of Speed Gauge routine ------------------------- */
//
/* ---------- Speed Gauge routine - Reference speed given by gauge ---------- */  
    function Speed_Gauge_SetUp_M1(){
      var retMsg;
      xmlDoc=loadXMLDoc("check_list.xml");
      var RequestedSpeed=xmlDoc.getElementsByTagName("M1_RequiredSpeed");

      gaugeSPEED_M1.NeedleID = 1;
      succ = pcm.WriteVariable(RequestedSpeed[0].childNodes[0].nodeValue, gaugeSPEED_M1.NeedleValue, retMsg);
      
    }  

   
/* --------------------- End of Speed Gauge routine ------------------------- */
//  
/* ------------------------ State machine for both motors ------------------- */  
    // State amchine for Motor 1
    function StateMachine_M1(){
      var ValueState;
      
      xmlDoc=loadXMLDoc("check_list.xml");
      var ActualState=xmlDoc.getElementsByTagName("M1_states")[0].getAttribute("FreemasterName");
            
      if(pcm.ReadVariable(ActualState))
      {
        xmlDoc=loadXMLDoc("check_list.xml");
        var states=xmlDoc.getElementsByTagName("M1_state"); 
        ValueState = pcm.LastVariable_vValue;
  
        var x=document.getElementById('M1_State_table').rows;
        var y=x[0].cells;
        y[0].align="center";
        y[0].innerHTML =  states[ValueState].childNodes[0].nodeValue;  
        y[0].className = "stateTableCell";
        
        if(ValueState == 6)
        {  
          document.getElementById('M1_State_table').style.background = "#FF9999";
        }      
        else
        {
          document.getElementById('M1_State_table').style.background = "transparent";  
        }    
     }
     document.getElementById('M1_State_table').className = "stateTable";         
     }
/* ------------------ End of  State machine for motor 1 --------------------- */  
//     
//
/* -----------------------  loadXMLDoc() routine -----------------------------*/  
   function loadXMLDoc(dname) 
    {
      try //Internet Explorer
      {
        xmlDoc=new ActiveXObject("Msxml2.DOMDocument.3.0");
      }
      catch(e)
      {
        try //Firefox, Mozilla, Opera, etc.
      {
        xmlDoc=document.implementation.createDocument("","",null);
      }
      catch(e) {alert(e.message)}
      }
      try 
      {
      xmlDoc.async=false;
      xmlDoc.load(dname);
      return(xmlDoc);
    }
    catch(e) {alert(e.message)}
    return(null);
    }  
	
	function getParentHtmlValue(valueId)
{
    var object      = null;
    
    if((document.getElementById("settingTab") != undefined)||(document.getElementById("mainPageTab") != undefined))
    {
        // add prefix to var ID
        object = parent.document.getElementById(valueId).innerHTML;
    }
    else
    {
      //get active motor to selct proper prefix
      var prefixM = getActiveMotor();
      // add prefix to var ID
      try{
        object = Number(parent.document.getElementById(prefixM + valueId).innerHTML);
      
      }
      catch(err){
        window.alert(("getParentHtmlValue"+prefixM+valueId).toString());
      };
    }
     
    return (object);  
    }
	
	function getVoltageGaugePar()
{
    var UDCmax = getParentHtmlValue('M1_UDC_MAX');
    var UDCtrip = getParentHtmlValue('M1_UDC_trip');
    var UDCunder = getParentHtmlValue('M1_UDC_under');
    var UDCover = getParentHtmlValue('M1_UDC_over');
    var UDCtick = 0;
    var UDCtickNo = 5;
    
    if(UDCtrip > UDCmax)  { UDCtrip = UDCmax;}
    if(UDCunder > UDCmax)  { UDCunder = UDCmax;}
    if(UDCover > UDCmax)  { UDCover = UDCmax;}
    if(UDCtrip > UDCover)  { UDCtrip = UDCover;}
    
    //Calculate the number of ticks
    var UDCnumerator = 1000; 
    while(UDCtick === 0)
    {
        if((UDCmax === 0)||(UDCmax === undefined))
        {
          alert("Error");
          UDCtick = 6;
          UDCmax = 25;
          break;
        } 
        UDCtick= Math.round(UDCmax/UDCnumerator/UDCtickNo)*(UDCnumerator);
        
        UDCnumerator = UDCnumerator / 10; 
    }   
    if((UDCtick*UDCtickNo)>UDCmax)
        UDCtick = UDCtick/2;
	
	document.write("<OBJECT  id=\"gaugeVdcBUS_M1\" width=\"300\" height=\"100\" codeBase=\"agauge.cab\" classid=\"clsid:B2E0C2EA-A543-11CF-BC8C-207402C10627\">");
    document.write("<param name=\"_Version\" value=\"131082\">");
    document.write("<param name=\"_ExtentX\" value=\"5900\">");
    document.write("<param name=\"_ExtentY\" value=\"2461\">");
    document.write("<param name=\"_StockProps\" value=\"70\">");
    document.write("<param name=\"Caption\" value>");
    document.write("<param name=\"Enabled\" value=\"-1\">");
    document.write("<param name=\"BackColor\" value=\"14540253\">");
    document.write("<param name=\"AutoRedraw\" value=\"-1\">");
    document.write("<param name=\"BevelInner\" value=\"0\">");
    document.write("<param name=\"BevelOuter\" value=\"1\">");
    document.write("<param name=\"BevelWidth\" value=\"0\">");
    document.write("<param name=\"BorderWidth\" value=\"0\">");
    document.write("<param name=\"BorderType\" value=\"1\">");
    document.write("<param name=\"Outline\" value=\"0\">");
    document.write("<param name=\"OutlineAlign\" value=\"0\">");
    document.write("<param name=\"OutlineColor\" value=\"0\">");
    document.write("<param name=\"OutlineTitle\" value=\"PMSM\">");
    document.write("<param name=\"OutlineWidth\" value=\"1\">");
    document.write("<param name=\"FocusOutline\" value=\"0\">");
    document.write("<param name=\"FrameBottom\" value=\"1.15\">");
    document.write("<param name=\"FrameColor\" value=\"8421440\">");
    document.write("<param name=\"FrameLeft\" value=\"-0.95\">");
    document.write("<param name=\"FrameRight\" value=\"1.15\">");
    document.write("<param name=\"FrameShape??0\" value=\"0,100, 100,0, 900,0, 1000,100, 1000,900, 900,1000, 100,1000, 0,900\">");
    document.write("<param name=\"FrameStyle\" value=\"0\">");
    document.write("<param name=\"FrameTop\" value=\"-1.15\">");
    document.write("<param name=\"ScaleSize\" value=\"1\">");
    document.write("<param name=\"ScaleDirection0\" value=\"0\">");
    document.write("<param name=\"ScaleMaxValue0\" value=\""+UDCmax+"\">");
    document.write("<param name=\"ScaleMinValue0\" value=\"0\">");
    document.write("<param name=\"ScaleOriginX0\" value=\"-0.07\">");
    document.write("<param name=\"ScaleOriginY0\" value=\"-5.5\">");
    document.write("<param name=\"ScaleStartAngle0\" value=\"335\">");
    document.write("<param name=\"ScaleStopAngle0\" value=\"25\">");
    document.write("<param name=\"FontSize\" value=\"2\">");
    document.write("<param name=\"CaptionSize\" value=\"2\">");
    document.write("<param name=\"CaptionColor0\" value=\"0\">");
    document.write("<param name=\"CaptionFontID0\" value=\"1\">");
    document.write("<param name=\"Caption0\" value=\"DC Bus Voltage\">");
    document.write("<param name=\"CaptionX0\" value=\"0\">");
    document.write("<param name=\"CaptionY0\" value=\"-0.28\">");
    document.write("<param name=\"CaptionAlign0\" value=\"2\">");
    document.write("<param name=\"CaptionVisible0\" value=\"-1\">");
    document.write("<param name=\"CaptionFlag0\" value=\"0\">");
    document.write("<param name=\"CaptionColor1\" value=\"0\">");
    document.write("<param name=\"CaptionFontID1\" value=\"1\">");
    document.write("<param name=\"Caption1\" value=\"[V]\">");
    document.write("<param name=\"CaptionX1\" value=\"0\">");
    document.write("<param name=\"CaptionY1\" value=\"-0.68\">");
    document.write("<param name=\"CaptionAlign1\" value=\"2\">");
    document.write("<param name=\"CaptionVisible1\" value=\"-1\">");
    document.write("<param name=\"CaptionFlag1\" value=\"0\">");
    document.write("<param name=\"CaptionFlag2\" value=\"0\">");
    
    document.write("<param name=\"AnnularSize\" value=\"5\">");
    
    document.write("<param name=\"AnnularColor0\" value=\"8454143\">");
    document.write("<param name=\"AnnularFloat0\" value=\"0\">");
    document.write("<param name=\"AnnularFloatOffset0\" value=\"0\">");
    document.write("<param name=\"AnnularInnerRadius0\" value=\"5.75\">");
    document.write("<param name=\"AnnularOuterRadius0\" value=\"6\">");
    document.write("<param name=\"AnnularScaleID0\" value=\"0\">");
    document.write("<param name=\"AnnularStartValue0\" value=\""+UDCunder+"\">");
    document.write("<param name=\"AnnularStopValue0\" value=\""+(UDCunder/0.91)+"\">");
    document.write("<param name=\"AnnularVisible0\" value=\"-1\">");
    
    document.write("<param name=\"AnnularColor1\" value=\"6348713\">");
    document.write("<param name=\"AnnularFloat1\" value=\"0\">");
    document.write("<param name=\"AnnularFloatOffset1\" value=\"0\">");
    document.write("<param name=\"AnnularInnerRadius1\" value=\"5.75\">");
    document.write("<param name=\"AnnularOuterRadius1\" value=\"6\">");
    document.write("<param name=\"AnnularScaleID1\" value=\"0\">");
    document.write("<param name=\"AnnularStartValue1\" value=\""+(UDCunder/0.91)+"\">");
    document.write("<param name=\"AnnularStopValue1\" value=\""+UDCtrip+"\">");
    document.write("<param name=\"AnnularVisible1\" value=\"-1\">");
    
    document.write("<param name=\"AnnularColor2\" value=\"8454143\">");
    document.write("<param name=\"AnnularFloat2\" value=\"0\">");
    document.write("<param name=\"AnnularFloatOffset2\" value=\"0\">");
    document.write("<param name=\"AnnularInnerRadius2\" value=\"5.75\">");
    document.write("<param name=\"AnnularOuterRadius2\" value=\"6\">");
    document.write("<param name=\"AnnularScaleID2\" value=\"0\">");
    document.write("<param name=\"AnnularStartValue2\" value=\""+UDCtrip+"\">");
    document.write("<param name=\"AnnularStopValue2\" value=\""+UDCover+"\">");
    document.write("<param name=\"AnnularVisible2\" value=\"-1\">");
    
    document.write("<param name=\"AnnularColor3\" value=\"500\">");
    document.write("<param name=\"AnnularFloat3\" value=\"0\">");
    document.write("<param name=\"AnnularFloatOffset3\" value=\"0\">");
    document.write("<param name=\"AnnularInnerRadius3\" value=\"5.75\">");
    document.write("<param name=\"AnnularOuterRadius3\" value=\"6\">");
    document.write("<param name=\"AnnularScaleID3\" value=\"0\">");
    document.write("<param name=\"AnnularStartValue3\" value=\""+UDCover+"\">");
    document.write("<param name=\"AnnularStopValue3\" value=\""+UDCmax+"\">");
    document.write("<param name=\"AnnularVisible3\" value=\"-1\">");
    
    document.write("<param name=\"AnnularColor4\" value=\"500\">");
    document.write("<param name=\"AnnularFloat4\" value=\"0\">");
    document.write("<param name=\"AnnularFloatOffset4\" value=\"0\">");
    document.write("<param name=\"AnnularInnerRadius4\" value=\"5.75\">");
    document.write("<param name=\"AnnularOuterRadius4\" value=\"6\">");
    document.write("<param name=\"AnnularScaleID4\" value=\"0\">");
    document.write("<param name=\"AnnularStartValue4\" value=\"0\">");
    document.write("<param name=\"AnnularStopValue4\" value=\""+(UDCunder)+"\">");
    document.write("<param name=\"AnnularVisible4\" value=\"-1\">");
    
    document.write("<param name=\"HubSize\" value=\"0\">");
    document.write("<param name=\"NeedleSize\" value=\"1\">");
    document.write("<param name=\"NeedleColor0\" value=\"9072936\">");
    document.write("<param name=\"NeedleDigital0\" value=\"0\">");
    document.write("<param name=\"NeedleDigitalColor0\" value=\"0\">");
    document.write("<param name=\"NeedleDigitalDecimals0\" value=\"0\">");
    document.write("<param name=\"NeedleDigitalFontID0\" value=\"0\">");
    document.write("<param name=\"NeedleDigitalX0\" value=\"0\">");
    document.write("<param name=\"NeedleDigitalY0\" value=\"0\">");
    document.write("<param name=\"NeedleLength0\" value=\"5.60\">");
    document.write("<param name=\"NeedleMouseControl0\" value=\"0\">");
    document.write("<param name=\"NeedleScaleID0\" value=\"0\">");
    document.write("<param name=\"NeedleShape??0\" value>");
    document.write("<param name=\"NeedleStyle0\" value=\"0\">");
    document.write("<param name=\"NeedleValue0\" value=\"0\">");
    document.write("<param name=\"NeedleWidth0\" value=\"0.04\">");
    document.write("<param name=\"NeedleVisible0\" value=\"-1\">");
    document.write("<param name=\"NeedleClip0\" value=\"-1\">");
    document.write("<param name=\"TicSize\" value=\"5\">");
    document.write("<param name=\"TicColor0\" value=\"0\">");
    document.write("<param name=\"TicFloat0\" value=\"0\">");
    document.write("<param name=\"TicDeltaValue0\" value=\""+UDCtick+"\">");
    document.write("<param name=\"TicFloatOffset0\" value=\"0\">");
    document.write("<param name=\"TicFontID0\" value=\"0\">");
    document.write("<param name=\"TicInnerRadius0\" value=\"5.75\">");
    document.write("<param name=\"TicLabel0\" value=\"-1\">");
    document.write("<param name=\"TicLabelRadius0\" value=\"6.5\">");
    document.write("<param name=\"TicLabelRotated0\" value=\"0\">");
    document.write("<param name=\"TicOuterRadius0\" value=\"6.2\">");
    document.write("<param name=\"TicScaleID0\" value=\"0\">");
    document.write("<param name=\"TicStartValue0\" value=\"0\">");
    document.write("<param name=\"TicStopValue0\" value=\""+UDCmax+"\">");
    document.write("<param name=\"TicStyle0\" value=\"0\">");
    document.write("<param name=\"TicWidth0\" value=\"0\">");
    document.write("<param name=\"TicVisible0\" value=\"-1\">");
    document.write("<param name=\"TicAutoTic0\" value=\"0\">");
    document.write("<param name=\"TicCount0\" value=\""+UDCtickNo+"\">");
    document.write("<param name=\"TicSubCount0\" value=\"0\">");
    document.write("<param name=\"TicColor1\" value=\"0\">");
    document.write("<param name=\"TicFloat1\" value=\"0\">");
    document.write("<param name=\"TicDeltaValue1\" value=\""+(UDCtick/UDCtickNo)+"\">");
    document.write("<param name=\"TicFloatOffset1\" value=\"0\">");
    document.write("<param name=\"TicFontID1\" value=\"0\">");
    document.write("<param name=\"TicInnerRadius1\" value=\"5.75\">");
    document.write("<param name=\"TicLabel1\" value=\"0\">");
    document.write("<param name=\"TicLabelRadius1\" value=\"1\">");
    document.write("<param name=\"TicLabelRotated1\" value=\"0\">");
    document.write("<param name=\"TicOuterRadius1\" value=\"6\">");
    document.write("<param name=\"TicScaleID1\" value=\"0\">");
    document.write("<param name=\"TicStartValue1\" value=\"0\">");
    document.write("<param name=\"TicStopValue1\" value=\""+UDCmax+"\">");
    document.write("<param name=\"TicStyle1\" value=\"0\">");
    document.write("<param name=\"TicWidth1\" value=\"0\">");
    document.write("<param name=\"TicVisible1\" value=\"-1\">");
    document.write("<param name=\"TicAutoTic1\" value=\"0\">");
    document.write("<param name=\"TicCount1\" value=\""+UDCtickNo+"\">");
    document.write("<param name=\"TicSubCount1\" value=\"0\">");
    document.write("</OBJECT>");
	
	}
	
		function getSpeedGaugePar()
{
    var Nnom = getParentHtmlValue('M1_N_nom');
	var Nmax = getParentHtmlValue('M1_N_max');
	var Nmin = getParentHtmlValue('M1_SPEED_MIN');
	
	document.write("<OBJECT id=\"gaugeSPEED_M1\" codeBase=\"agauge.cab\" classid=\"clsid:B2E0C2EA-A543-11CF-BC8C-207402C10627\" width=\"300\" height=\"180\" VIEWASTEXT>");
	document.write("<param name=\"_Version\" value=\"131082\">");
	document.write("<param name=\"_Version\" value=\"131082\">");
	document.write("<param name=\"_ExtentX\" value=\"8837\">");
	document.write("<param name=\"_ExtentY\" value=\"5371\">");
	document.write("<param name=\"_StockProps\" value=\"70\">");
	document.write("<param name=\"Caption\" value>");
	document.write("<param name=\"Enabled\" value=\"-1\">");
	document.write("<param name=\"BackColor\" value=\"14277081\">");
	document.write("<param name=\"AutoRedraw\" value=\"-1\">");
	document.write("<param name=\"BevelInner\" value=\"2\">");
	document.write("<param name=\"BevelOuter\" value=\"1\">");
	document.write("<param name=\"BevelWidth\" value=\"1\">");
	document.write("<param name=\"BorderWidth\" value=\"2\">");
	document.write("<param name=\"BorderType\" value=\"1\">");
	document.write("<param name=\"Outline\" value=\"0\">");
	document.write("<param name=\"OutlineAlign\" value=\"2\">");
	document.write("<param name=\"OutlineColor\" value=\"0\">");
	document.write("<param name=\"OutlineTitle\" value>");
	document.write("<param name=\"OutlineWidth\" value=\"1\">");
	document.write("<param name=\"FocusOutline\" value=\"0\">");
	document.write("<param name=\"FrameBottom\" value=\"1.29\">");
	document.write("<param name=\"FrameColor\" value=\"8421440\">");
	document.write("<param name=\"FrameLeft\" value=\"-2.25\">");
	document.write("<param name=\"FrameRight\" value=\"2.25\">");
	document.write("<param name=\"FrameShape??0\" value=\"0,180, 100,0, 900,0, 1000,180, 1000,820, 900,1000, 100,1000, 0,820\">");
	document.write("<param name=\"FrameStyle\" value=\"0\">");
	document.write("<param name=\"FrameTop\" value=\"-1.5\">");
	document.write("<param name=\"ScaleSize\" value=\"1\">");
	document.write("<param name=\"ScaleDirection0\" value=\"0\">");
	document.write("<param name=\"ScaleMaxValue0\" value=\""+Nmax+"\">");
	document.write("<param name=\"ScaleMinValue0\" value=\"0\">");
	document.write("<param name=\"ScaleOriginX0\" value=\"0\">");
	document.write("<param name=\"ScaleOriginY0\" value=\"-0.45\">");
	document.write("<param name=\"ScaleStartAngle0\" value=\"245\">");
	document.write("<param name=\"ScaleStopAngle0\" value=\"115\">");
	document.write("<param name=\"FontSize\" value=\"2\">");
	document.write("<param name=\"CaptionSize\" value=\"2\">");
	document.write("<param name=\"CaptionColor0\" value=\"#450000\">");
	document.write("<param name=\"CaptionFontID0\" value=\"0\">");
	document.write("<param name=\"Caption0\" value=\"Speed\">");
	document.write("<param name=\"CaptionX0\" value=\"0\">");
	document.write("<param name=\"CaptionY0\" value=\"-0.7\">");
	document.write("<param name=\"CaptionAlign0\" value=\"2\">");
	document.write("<param name=\"CaptionVisible0\" value=\"-1\">");
	document.write("<param name=\"CaptionFlag0\" value=\"0\">");
	document.write("<param name=\"CaptionColor1\" value=\"#450000\">");
	document.write("<param name=\"CaptionFontID1\" value=\"0\">");
	document.write("<param name=\"Caption1\" value=\"[RPM]\">");
	document.write("<param name=\"CaptionX1\" value=\"0\">");
	document.write("<param name=\"CaptionY1\" value=\"-0.9\">");
	document.write("<param name=\"CaptionAlign1\" value=\"2\">");
	document.write("<param name=\"CaptionVisible1\" value=\"-1\">");
	document.write("<param name=\"CaptionFlag1\" value=\"0\">");
	document.write("<param name=\"AnnularSize\" value=\"4\">");
	document.write("<param name=\"AnnularColor0\" value=\"60280\">");
	document.write("<param name=\"AnnularFloat0\" value=\"0\">");
	document.write("<param name=\"AnnularFloatOffset0\" value=\"0\">");
	document.write("<param name=\"AnnularInnerRadius0\" value=\"0.9\">");
	document.write("<param name=\"AnnularOuterRadius0\" value=\"1\">");
	document.write("<param name=\"AnnularScaleID0\" value=\"0\">");
	document.write("<param name=\"AnnularStartValue0\" value=\"0\">");
	document.write("<param name=\"AnnularStopValue0\" value=\""+Nmax+"\">");
	document.write("<param name=\"AnnularVisible0\" value=\"-1\">");
	document.write("<param name=\"AnnularColor1\" value=\"500\">");
	document.write("<param name=\"AnnularFloat1\" value=\"0\">");
	document.write("<param name=\"AnnularFloatOffset1\" value=\"0\">");
	document.write("<param name=\"AnnularInnerRadius1\" value=\"0.9\">");
	document.write("<param name=\"AnnularOuterRadius1\" value=\"1\">");
	document.write("<param name=\"AnnularScaleID1\" value=\"0\">");
	document.write("<param name=\"AnnularStartValue1\" value=\"0\">");
	document.write("<param name=\"AnnularStopValue1\" value=\""+Nmin+"\">");
	document.write("<param name=\"AnnularVisible1\" value=\"-1\">");
	document.write("<param name=\"AnnularColor3\" value=\"600\">");
	document.write("<param name=\"AnnularFloat3\" value=\"0\">");
	document.write("<param name=\"AnnularFloatOffset3\" value=\"0\">");
	document.write("<param name=\"AnnularInnerRadius3\" value=\"0.9\">");
	document.write("<param name=\"AnnularOuterRadius3\" value=\"1\">");
	document.write("<param name=\"AnnularScaleID3\" value=\"0\">");
	document.write("<param name=\"AnnularStartValue3\" value=\""+Nnom+"\">");
	document.write("<param name=\"AnnularStopValue3\" value=\""+Nmax+"\">");
	document.write("<param name=\"AnnularVisible3\" value=\"-1\">");
	document.write("<param name=\"HubSize\" value=\"2\">");
	document.write("<param name=\"HubColor0\" value=\"12632256\">");
	document.write("<param name=\"HubRadius0\" value=\"0.119\">");
	document.write("<param name=\"HubScaleID0\" value=\"0\">");
	document.write("<param name=\"HubStyle0\" value=\"0\">");
	document.write("<param name=\"HubVisible0\" value=\"-1\">");
	document.write("<param name=\"HubColor1\" value=\"9539985\">");
	document.write("<param name=\"HubRadius1\" value=\"0.089\">");
	document.write("<param name=\"HubScaleID1\" value=\"0\">");
	document.write("<param name=\"HubStyle1\" value=\"0\">");
	document.write("<param name=\"HubVisible1\" value=\"-1\">");
	document.write("<PARAM NAME=\"NeedleSize\" VALUE=\"2\">");
	document.write("<PARAM NAME=\"NeedleDigitalFontID0\" VALUE=\"1\">");
	document.write("<PARAM NAME=\"NeedleDigitalY0\" VALUE=\"-0.68\">");
	document.write("<PARAM NAME=\"NeedleLength0\" VALUE=\"0.8\">");
	document.write("<PARAM NAME=\"NeedleWidth0\" VALUE=\"0.08\">");
	document.write("<PARAM NAME=\"NeedleVisible0\" VALUE=\"-1\">");
	document.write("<PARAM NAME=\"NeedleColor1\" VALUE=\"470\">");
	document.write("<PARAM NAME=\"NeedleLength1\" VALUE=\"0.8\">");
	document.write("<PARAM NAME=\"NeedleMouseControl1\" VALUE=\"2\">");
	document.write("<PARAM NAME=\"NeedleValue1\" VALUE=\"413.600131157056\">");
	document.write("<PARAM NAME=\"NeedleWidth1\" VALUE=\"0.05\">");
	document.write("<PARAM NAME=\"NeedleVisible1\" VALUE=\"-1\">");
	document.write("<PARAM NAME=\"NeedleClip1\" VALUE=\"-1\">");
	document.write("<param name=\"TicSize\" value=\"2\">");
	document.write("<param name=\"TicColor0\" value=\"0\">");
	document.write("<param name=\"TicFloat0\" value=\"0\">");
	document.write("<param name=\"TicDeltaValue0\" value=\"500\">");
	document.write("<param name=\"TicFloatOffset0\" value=\"0\">");
	document.write("<param name=\"TicFontID0\" value=\"0\">");
	document.write("<param name=\"TicInnerRadius0\" value=\"0.9\">");
	document.write("<param name=\"TicLabel0\" value=\"-1\">");
	document.write("<param name=\"TicLabelRadius0\" value=\"1.30\">");
	document.write("<param name=\"TicLabelRotated0\" value=\"0\">");
	document.write("<param name=\"TicOuterRadius0\" value=\"1.10\">");
	document.write("<param name=\"TicScaleID0\" value=\"0\">");
	document.write("<param name=\"TicStartValue0\" value=\"0\">");
	document.write("<param name=\"TicStopValue0\" value=\""+Nmax+"\">");
	document.write("<param name=\"TicStyle0\" value=\"0\">");
	document.write("<param name=\"TicWidth0\" value=\"0\">");
	document.write("<param name=\"TicVisible0\" value=\"-1\">");
	document.write("<param name=\"TicAutoTic0\" value=\"0\">");
	document.write("<param name=\"TicCount0\" value=\"6\">");
	document.write("<param name=\"TicSubCount0\" value=\"0\">");
	document.write("<param name=\"TicColor1\" value=\"0\">");
	document.write("<param name=\"TicFloat1\" value=\"0\">");
	document.write("<param name=\"TicDeltaValue1\" value=\"100\">");
	document.write("<param name=\"TicFloatOffset1\" value=\"0\">");
	document.write("<param name=\"TicFontID1\" value=\"0\">");
	document.write("<param name=\"TicInnerRadius1\" value=\"0.9\">");
	document.write("<param name=\"TicLabel1\" value=\"0\">");
	document.write("<param name=\"TicLabelRadius1\" value=\"0.8\">");
	document.write("<param name=\"TicLabelRotated1\" value=\"0\">");
	document.write("<param name=\"TicOuterRadius1\" value=\"1.00\">");
	document.write("<param name=\"TicScaleID1\" value=\"0\">");
	document.write("<param name=\"TicStartValue1\" value=\"0000\">");
	document.write("<param name=\"TicStopValue1\" value=\""+Nmax+"\">");
	document.write("<param name=\"TicStyle1\" value=\"0\">");
	document.write("<param name=\"TicWidth1\" value=\"0\">");
	document.write("<param name=\"TicVisible1\" value=\"-1\">");
	document.write("<param name=\"TicAutoTic1\" value=\"0\">");
	document.write("<param name=\"TicCount1\" value=\"6\">");
	document.write("<param name=\"TicSubCount1\" value=\"0\">");
	document.write("</OBJECT>");
    }
  
  </script>
  
  </head>
  <body onLoad="Init()" background="background.png">
  
                                       
                                  
  <OBJECT id="MCB_PC_Master_Services1" height="1" width="1" classid="clsid:48A185F1-FFDB-11D3-80E3-00C04F176153" name="pcm">
	</OBJECT>
	
  <OBJECT CLASSID = "clsid:5220cb21-c88d-11cf-b347-00aa00a28331">  <PARAM NAME="LPKPath" VALUE="gmsctls.lpk"> 
  </OBJECT>
   
  <div style=" position:absolute" >
    
  <table width="600px" cellspacing="5px" border="0"> 
    <tr>                                                      
    <td width="200" align="center" rowspan="2" valign="top">
    <div class="fontSectionLable">Application Faults</div>
    <div id="errors_tab_M1"></div>
    </td> 
      
   <td width="300" align="right">
   		<script language="VBScript"> 
									getVoltageGaugePar()
		</script>		
    </td>  
    </tr>     					
     <tr>
     <td>
                 
                                    <script language="VBScript">   
									getSpeedGaugePar()														
                                    Sub gaugeSPEED_M1_change()     'agauge Change event handled by VBScript 
                                        Speed_Gauge_SetUp_M1()     'JScript handler call
										
                                    End Sub
									
									
                                    </script>
                                                                                  
            
								
    </td> 
    </tr>  
 </table>             
  
   <table width="600px" border="0" > 
    <tr>       

    <td width="200" align="center">
    <div class="fontControl">ON/OFF</div>      
    <img class="xlink" src="OffBut.png" name="onoff_M1" onMouseDown="Power_click_M1()" >
    </td> 
    
    <td width="200" align="center">
    <div class="fontControl" style="padding-bottom: 2px">Application State</div> 
    <table id="M1_State_table"  cellspacing="5px" width="150px" height="70" border="5">
      <td >    
      </td>
    </table>
    </td>

  
    <td width="200" align="center">
    <div class="fontControl" style="padding-bottom: 5px" >Clear Faults</div>
    <img class="xlink" src="GreenBut.png"  name="fltClr_M1" onMouseDown="Fault_clr_click_M1()">
    </td>
    
    </table>
    </td>  

 
    </tr>  
  </table>   
  
   
  <span style="visibility: hidden" face="sans-serif" id="txtErrMsg">.</span>  
  </div>
  </body>
</html>
