## 💡 센서리스 BLDC 6-Step 제어 핵심 요약
센서리스(Sensorless) 6-Step 제어는 모터 권선에 유도되는 **역기전력(BEMF)**을 이용해 로터의 위치를 파악하고, 이에 맞춰 3상(U, V, W)을 순차적으로 전환(Commutation)하는 방식입니다.

---

### 1. ⚙️ 센서리스 제어의 핵심 원리: BEMF 감지

* **BEMF 생성**: BLDC 모터의 3개 상 중 구동하지 않는 **한 개 상을 High-Z 상태**로 두면, 모터가 발전기처럼 **BEMF(Back EMF)**를 생성합니다.
* **위치 센서 역할**: 이 BEMF는 로터의 **현재 위치 정보**를 담고 있으며, 코일 자체가 위치 센서 역할을 수행합니다.
* **구조**: 3상 BEMF는 전기적으로 $120^\circ$의 위상차를 가집니다.

---

### 2. ⚡ Zero-Cross (ZC) 이벤트와 위치 파악

| 용어 | 정의 | 물리적 의미 |
| :--- | :--- | :--- |
| **Zero-Cross (ZC)** | High-Z 상태의 상에서 측정된 BEMF가 **0V를 통과하는 순간**입니다. | 로터 자석이 해당 상 코일의 **중심을 정확히 지나가는 위치**입니다. |

* **제어 목표**: 센서리스 6-Step 제어는 이 **ZC 이벤트**를 정확히 파악하는 것에 달려 있습니다.
    

---

### 3. ⏱️ Commutation 타이밍: ZC + $30^\circ$ Delay

* **6-Step 구간**: 전기각 $360^\circ$를 $60^\circ$씩 나눈 6개의 구간으로 모터를 순차적으로 구동합니다.
* **ZC 발생 위치**: BLDC 구조상 ZC는 각 $60^\circ$ **Step의 정확한 중앙**인 $30^\circ$ 지점에서 발생합니다.
* **Commutation 시점**: 다음 Step으로의 상 전환(Commutation)은 현재 Step의 **끝($60^\circ$)**에서 이루어져야 합니다.
* **핵심 타이밍**: ZC 발생 후, Commutation이 이루어져야 하는 $60^\circ$ 지점까지 남은 $30^\circ$ 만큼 **Delay**가 필요합니다.
    $$\text{Commutation} = \text{ZC 발생} + 30^\circ \text{ Delay}$$

---

### 4. 🧭 속도 계산 및 위치 추정

#### 1. 속도 계산
* ZC는 모터가 **전기각 $30^\circ$** 이동할 때마다 발생합니다.
* ZC 이벤트 간의 시간 간격($\text{Time}_{30^\circ}$)을 측정하여 모터의 속도를 계산합니다.
    $$\text{Electrical RPM} = \frac{60}{\text{Time}_{30^\circ} \times 12}$$
    $$\text{Mechanical RPM} = \frac{\text{Electrical RPM}}{\text{Pole Pairs}}$$

#### 2. 위치 추정
* 6-Step 제어는 $30^\circ$ 단위 위치(ZC)만 정확히 알 수 있습니다.
* ZC 사이의 $30^\circ$ 구간은 측정된 속도를 기반으로 **위치를 추정**하여 다음 Commutation 타이밍을 계산합니다.

---

### 5. 🚀 힘(토크) 제어 방식

* **간접 제어**: 토크를 직접 계산하지 않고, **속도 오차**를 기반으로 PI 제어기를 사용해 간접적으로 제어합니다.
* **제어 흐름**:
    1.  **목표 속도 - 실제 속도** = **Error**
    2.  PI 제어기가 오차를 줄이기 위해 **PWM 듀티(Duty Cycle)**를 결정
    3.  **듀티 증가** $\rightarrow$ 인가 전압 증가 $\rightarrow$ **토크 증가**
    4.  토크 증가 $\rightarrow$ 모터 가속 $\rightarrow$ ZC가 빨리 발생 $\rightarrow$ **속도 증가** (오차 감소)
* **결론**: 속도 오차 기반의 PI 제어를 통해 **PWM 듀티**를 조절하여 모터의 토크를 제어합니다.
